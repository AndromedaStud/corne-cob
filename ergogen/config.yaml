units:
    screwHead: 2
    screwShaft: 1
points:
    key.padding: cy
    zones:
        main:
            rows:
                bottom.row_net: P2
                home.row_net: P0
                top.row_net: P1
            columns:
                pinky:
                    key:
                        col_net: P10
                        spread: cx
                    rows:
                        bottom:
                            led_in: "rgb_{{name}}"
                        home:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_pinky_bottom
                        top:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_pinky_home
                pinky2:
                    key:
                        col_net: P7
                        spread: cx
                    rows:
                        bottom:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_pinky2_home
                        home:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_pinky2_top
                        top:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_pinky_top
                ring:
                    key:
                        col_net: P6
                        stagger: 4
                        spread: cx
                    rows:
                        bottom:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_pinky2_bottom
                        home:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_ring_bottom
                        top:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_ring_home
                middle:
                    key:
                        col_net: P5
                        stagger: 2
                        spread: cx
                    rows:
                        bottom:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_middle_home
                        home:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_middle_top
                        top:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_ring_top
                index:
                    key:
                        col_net: P4
                        stagger: -2
                        spread: cx
                    rows:
                        bottom:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_thumb_home_home
                        home:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_index_bottom
                        top:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_index_home
                inner:
                    key:
                        col_net: P3
                        stagger: -2
                        spread: cx
                    rows:
                        bottom:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_inner_home
                        home:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_inner_top
                        top:
                            led_in: "rgb_{{name}}"
                            led_out: rgb_main_index_top
        thumb:
            anchor:
                ref: main_index_bottom
                shift: [-0.5cx, -cy]
            rows.home.row_net: P8
            columns:
                inner.key:
                    col_net: P5
                    led_in: "rgb_{{name}}"
                    led_out: rgb_main_middle_bottom
                    spread: cx
                home.key:
                    col_net: P4
                    led_in: "rgb_{{name}}"
                    led_out: rgb_thumb_inner_home
                    spread: cx + 2
                    rotate: -18
                    stagger: -3.2
                outer.key:
                    col_net: P3
                    led_in: P9
                    led_out: rgb_main_inner_bottom
                    spread: cx
                    rotate: -36
                    stagger: -9.20
                    height: 1.5u
                    shift: [0.25u,0.25u]
    mirror: &mirror
        ref: main_inner_top
        distance: 100
outlines:
    _board_outline:
        -   what: polygon
            fillet: 2
            points:
                -   ref: thumb_outer_home
                    shift: [0.6cx, 0.8cy]
                -   ref: thumb_outer_home
                    shift: [0.6cx, -0.8cy]
                -   ref: thumb_outer_home
                    shift: [-0.4cx, -0.8cy]

                -   ref: thumb_home_home
                    shift: [0.4cx, -0.6cy]
                -   ref: thumb_home_home
                    shift: [-0.4cx, -0.6cy]

                -   ref: thumb_inner_home
                    shift: [0.4cx, -0.6cy]
                -   ref: thumb_inner_home
                    shift: [-0.6cx, -0.6cy]

                -   ref: main_pinky_bottom
                    shift: [1.6cx, -0.6cy]
                -   ref: main_pinky_bottom
                    shift: [0.6cx, -0.6cy]
                -   ref: main_pinky_bottom
                    shift: [-0.6cx, -0.6cy]

                -   ref: main_pinky_top
                    shift: [-0.6cx, 0.6cy]
                -   ref: main_pinky_top
                    shift: [0.4cx, 0.6cy]

                -   ref: main_ring_top
                    shift: [-0.5cx, 0.6cy]
                -   ref: main_ring_top
                    shift: [0.4cx, 0.6cy]

                -   ref: main_middle_top
                    shift: [-0.4cx, 0.61cy]
                -   ref: main_middle_top
                    shift: [0.4cx, 0.6cy]

                -   ref: main_index_top
                    shift: [-0.4cx, 0.6cy]
                -   ref: main_index_top
                    shift: [0.5cx, 0.6cy]

                -   ref: main_inner_top
                    shift: [-0.4cx, 0.6cy]
                -   ref: main_inner_top
                    shift: [0.5cx, 0.6cy]

                -   ref: main_inner_top
                    shift: [0.6cx, 0.4cy]
                -   ref: main_inner_top
                    shift: [1.8cx, 0.4cy]

                -   ref: main_inner_bottom
                    shift: [1.8cx, -0.6cy]
    _board2_outline:
        -   what: polygon
            fillet: 2
            points:
                -   ref: mirror_thumb_outer_home
                    shift: [0.6cx, 0.8cy]
                -   ref: mirror_thumb_outer_home
                    shift: [0.6cx, -0.8cy]
                -   ref: mirror_thumb_outer_home
                    shift: [-0.4cx, -0.8cy]

                -   ref: mirror_thumb_home_home
                    shift: [0.4cx, -0.6cy]
                -   ref: mirror_thumb_home_home
                    shift: [-0.4cx, -0.6cy]

                -   ref: mirror_thumb_inner_home
                    shift: [0.4cx, -0.6cy]
                -   ref: mirror_thumb_inner_home
                    shift: [-0.6cx, -0.6cy]

                -   ref: mirror_main_pinky_bottom
                    shift: [1.6cx, -0.6cy]
                -   ref: mirror_main_pinky_bottom
                    shift: [0.6cx, -0.6cy]
                -   ref: mirror_main_pinky_bottom
                    shift: [-0.6cx, -0.6cy]

                -   ref: mirror_main_pinky_top
                    shift: [-0.6cx, 0.6cy]
                -   ref: mirror_main_pinky_top
                    shift: [0.4cx, 0.6cy]

                -   ref: mirror_main_ring_top
                    shift: [-0.5cx, 0.6cy]
                -   ref: mirror_main_ring_top
                    shift: [0.4cx, 0.6cy]

                -   ref: mirror_main_middle_top
                    shift: [-0.4cx, 0.61cy]
                -   ref: mirror_main_middle_top
                    shift: [0.4cx, 0.6cy]

                -   ref: mirror_main_index_top
                    shift: [-0.4cx, 0.6cy]
                -   ref: mirror_main_index_top
                    shift: [0.5cx, 0.6cy]

                -   ref: mirror_main_inner_top
                    shift: [-0.4cx, 0.6cy]
                -   ref: mirror_main_inner_top
                    shift: [0.5cx, 0.6cy]

                -   ref: mirror_main_inner_top
                    shift: [0.6cx, 0.4cy]
                -   ref: mirror_main_inner_top
                    shift: [1.8cx, 0.4cy]

                -   ref: mirror_main_inner_bottom
                    shift: [1.8cx, -0.6cy]
    _case_outline:
        -   what: polygon
            fillet: 2
            points:
                -   ref: thumb_outer_home
                    shift: [0.6cx + 2, 0.8cy + 1]
                -   ref: thumb_outer_home
                    shift: [0.6cx + 2, -0.8cy - 2]
                -   ref: thumb_outer_home
                    shift: [-0.4cx + 2, -0.8cy - 2]

                -   ref: thumb_home_home
                    shift: [0.4cx, -0.6cy - 2]
                -   ref: thumb_home_home
                    shift: [-0.4cx, -0.6cy - 2]

                -   ref: thumb_inner_home
                    shift: [0.4cx, -0.6cy - 2]
                -   ref: thumb_inner_home
                    shift: [-0.6cx, -0.6cy - 2]

                -   ref: main_pinky_bottom
                    shift: [1.6cx, -0.6cy - 2]
                -   ref: main_pinky_bottom
                    shift: [0.6cx, -0.6cy - 2]
                -   ref: main_pinky_bottom
                    shift: [-0.6cx - 2, -0.6cy - 2]

                -   ref: main_pinky_top
                    shift: [-0.6cx - 2, 0.6cy + 2]
                -   ref: main_pinky_top
                    shift: [0.4cx, 0.6cy + 2]

                -   ref: main_ring_top
                    shift: [-0.5cx, 0.6cy + 2]
                -   ref: main_ring_top
                    shift: [0.4cx, 0.6cy + 2]

                -   ref: main_middle_top
                    shift: [-0.4cx, 0.61cy + 2]
                -   ref: main_middle_top
                    shift: [0.4cx, 0.6cy + 2]

                -   ref: main_index_top
                    shift: [-0.4cx, 0.6cy + 2]
                -   ref: main_index_top
                    shift: [0.5cx, 0.6cy + 2]

                -   ref: main_inner_top
                    shift: [-0.4cx, 0.6cy + 2]
                -   ref: main_inner_top
                    shift: [0.5cx + 2, 0.6cy + 2]

                -   ref: main_inner_top
                    shift: [0.6cx + 2, 0.4cy + 2]
                -   ref: main_inner_top
                    shift: [1.8cx + 2, 0.4cy + 2]

                -   ref: main_inner_bottom
                    shift: [1.8cx + 2, -0.6cy + 2]
    _mounting:
        -   what: circle
            radius: screwHead
            where:
                ref: thumb_outer_home
                shift: [-11.5, -2]
        -   what: circle
            radius: screwHead
            where:
                ref: main_pinky_home
                shift: [9, 8.5]
        -   what: circle
            radius: screwHead
            where:
                ref: main_ring_bottom
                shift: [10, -17]
        -   what: circle
            radius: screwHead
            where:
                ref: main_pinky_bottom
                shift: [9, 8.5]
        -   what: circle
            radius: screwHead
            where:
                ref: main_index_home
                shift: [9, 7.5]
    _mounting_hole:
        -   what: circle
            radius: screwShaft
            where:
                ref: thumb_outer_home
                shift: [-11.5, -2]
        -   what: circle
            radius: screwShaft
            where:
                ref: main_pinky_home
                shift: [9, 8.5]
        -   what: circle
            radius: screwShaft
            where:
                ref: main_ring_bottom
                shift: [10, -17]
        -   what: circle
            radius: screwShaft
            where:
                ref: main_pinky_bottom
                shift: [9, 8.5]
        -   what: circle
            radius: screwShaft
            where:
                ref: main_index_home
                shift: [9, 7.5]
    _keycap_outlines:
        -   what: rectangle
            fillet: 2
            where: [/^main_.*/, /^thumb_.*/]
            size: [1cx - 0.5, 1cy - 0.5] # Choc keycaps are 17.5 x 16.5
    _keycap2_outlines:
        -   what: rectangle
            fillet: 2
            where: [/^mirror_main_.*/, /^mirror_thumb_.*/]
            size: [1cx - 0.5, 1cy - 0.5]
    _key_outline:
        -   what: rectangle
            where: [/^main_.*/, /^thumb_.*/]
            size: [14, 14]
            #fillet: 0.6
    _space_outline:
        -   what: rectangle
            fillet: 2
            where: [thumb_outer_home, mirror_thumb_outer_home]
            size: [1cx - 0.5, 1.5cy - 0.5]
    preview:
        -   what: outline
            name: _board_outline
            operation: stack
        -   what: outline
            name: _board2_outline
            operation: stack
        -   what: outline
            name: _keycap_outlines
            operation: stack
        -   what: outline
            name: _keycap2_outlines
            operation: stack
        -   what: outline
            name: _space_outline
            operation: stack
    preview2:
        -   what: outline
            name: _board_outline
            operation: stack
        -   what: outline
            name: _case_outline
            operation: stack
        -   what: outline
            name: _key_outline
            operation: stack
        -   what: outline
            name: _mounting
            operation: stack
        -   what: outline
            name: _mounting_hole
            operation: stack
cases:
    _model:
    -   what: outline
        name: _board2_outline
        extrude: 3
    -   what: outline
        name: _board_outline
        extrude: 3
    -   what: outline
        name: _keycap_outlines
        extrude: 6
        operation: add
    -   what: outline
        name: _keycap2_outlines
        extrude: 6
        operation: add
    -   what: outline
        name: _space_outline
        extrude: 6
        operation: add
    _bottomWall:
    -   what: outline
        name: _case_outline
        operation: add
        extrude: 10.8
    -   what: outline
        name: _board_outline
        operation: subtract
        extrude: 10.8
    _holes:
    -   what: outline
        name: _mounting
        extrude: 8
    -   what: outline
        name: _mounting_hole
        extrude: 8
        operation: subtract
    bottomCase:
    -   what: outline
        name: _case_outline
        operation: add
        extrude: 2
    -   what: case
        name: _bottomWall
        operation: add
    -   what: case
        name: _holes
        operation: add
    topCase:
    -   what: outline
        name: _case_outline
        operation: add
        extrude: 1.2
    -   what: outline
        name: _key_outline
        operation: subtract
        extrude: 1.2
    -   what: outline
        name: _mounting_hole
        operation: subtract
        extrude: 1.2


pcbs:
    corneL:
        outlines:
            main.outline: _board_outline
            keycaps:
                outline: _keycap_outlines
                layer: Eco1.User
        footprints:
            led:
                what: sk6812mini
                where: [/^main_.*/, /^thumb_.*/]
                adjust:
                    shift: [0, 5]
                params:
                    din: "{{led_in}}"
                    dout: "{{led_out}}"
                    cutout: true
            diode:
                what: sod-123w
                where: [/^main_.*/, /^thumb_.*/]
                params:
                    from: "{{name}}"
                    to: "{{row_net}}"
                adjust:
                    shift: [ -7.6, 1.6 ]
                    rotate: 90
            choc:
                what: choc
                where: [/^main_.*/, /^thumb_.*/]
                params:
                    keycaps: true
                    reverse: false
                    hotswap: true
                    from: "{{col_net}}"
                    to: "{{name}}"
                adjust:
                    rotate: 180
            nice_nano:
                what: nice_nano
                where:
                    ref: main_inner_home
                params:
                    orientation: down
                adjust:
                    shift: [22, 6.5]
                    rotate: -90
            oled:
                what: oled
                params:
                    side: "F"
                    SDA: P2
                    SCL: P3
                where:
                    ref: main_inner_home
                adjust:
                    shift: [16, -12]
                    rotate: 90
            jstph:
                what: jstph
                where:
                    ref: main_inner_bottom
                    shift: [21, -2]
                    rotate: -90
                params:
                    side: B
                    pos: pos
                    neg: GND
                        
            power_switch:
                what: slider
                where:
                    ref: main_inner_bottom
                    shift: [30.5, 3]
                    rotate: -90
                params:
                    side: B
                    from: pos
                    to: RAW

            horizontal_reset:
                what: EVQPUC
                where:
                    ref: main_inner_bottom
                    shift: [30, -6]
                    rotate: -90
                params:
                    side: B 
                    from: GND
                    to: RST 
            
            mountinghole1:
                what: mountinghole
                where:
                    ref: thumb_outer_home
                    shift: [-11.5, -2]
            mountinghole2:
                what: mountinghole
                where:
                    ref: main_pinky_home
                    shift: [9, 8.5]
            mountinghole3:
                what: mountinghole
                where:
                    ref: main_ring_bottom
                    shift: [10, -17]
            mountinghole4:
                what: mountinghole
                where:
                    ref: main_pinky_bottom
                    shift: [9, 8.5]
            mountinghole5:
                what: mountinghole
                where:
                    ref: main_index_home
                    shift: [9, 7.5]




    corneR:
        outlines:
            main.outline: _board2_outline
            keycaps:
                outline: _keycap2_outlines
                layer: Eco1.User
        footprints:
            led:
                what: sk6812mini
                where: [/^mirror_main_.*/, /^mirror_thumb_.*/]
                adjust:
                    shift: [0, 5]
                params:
                    din: "{{led_in}}"
                    dout: "{{led_out}}"
                    cutout: true
            diode:
                what: sod-123w
                where: [/^mirror_main_.*/, /^mirror_thumb_.*/]
                params:
                    from: "{{name}}"
                    to: "{{row_net}}"
                adjust:
                    shift: [ 7.6, 1.6 ]
                    rotate: 90
            choc:
                what: choc
                where: [/^mirror_main_.*/, /^mirror_thumb_.*/]
                params:
                    keycaps: true
                    reverse: false
                    hotswap: true
                    from: "{{col_net}}"
                    to: "{{name}}"
                adjust:
                    rotate: 180
            nice_nano:
                what: nice_nano
                where:
                    ref: mirror_main_inner_home
                params:
                    orientation: down
                adjust:
                    shift: [22, 6.5]
                    rotate: 90
            oled:
                what: oled
                params:
                    side: "F"
                    SDA: P2
                    SCL: P3
                where:
                    ref: mirror_main_inner_home
                adjust:
                    shift: [28, -12]
                    rotate: -90
            jstph:
                what: jstph
                where:
                    ref: mirror_main_inner_bottom
                    shift: [21, -2]
                    rotate: -90
                params:
                    side: B
                    pos: pos
                    neg: GND

            power_switch:
                what: slider
                where:
                    ref: mirror_main_inner_bottom
                    shift: [30.5, 3]
                    rotate: -90
                params:
                    side: B
                    from: pos
                    to: RAW

            horizontal_reset:
                what: EVQPUC
                where:
                    ref: mirror_main_inner_bottom
                    shift: [30, -6]
                    rotate: -90
                params: 
                    side: B
                    from: GND
                    to: RST 

            mountinghole1:
                what: mountinghole
                where:
                    ref: mirror_thumb_outer_home
                    shift: [-11.5, -2]
            mountinghole2:
                what: mountinghole
                where:
                    ref: mirror_main_pinky_home
                    shift: [9, 8.5]
            mountinghole3:
                what: mountinghole
                where:
                    ref: mirror_main_ring_bottom
                    shift: [10, -17]
            mountinghole4:
                what: mountinghole
                where:
                    ref: mirror_main_pinky_bottom
                    shift: [9, 8.5]
            mountinghole5:
                what: mountinghole
                where:
                    ref: mirror_main_index_home
                    shift: [9, 7.5]